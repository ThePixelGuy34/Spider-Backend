const web = require("express");
const app = web.Router();
const log = require("../utils/log/log.js");

//proeprp
app.use((req, res, next) => {
    if (req.path.includes('.env')) {
        let geekedip = req.headers['x-forwarded-for'] || req.connection.remoteAddress || req.socket.remoteAddress || req.connection.socket.remoteAddress;
        if (geekedip.includes('::ffff:')) {
            geekedip = geekedip.split('::ffff:')[1];
        }
        log.warn(`Someone tried to access the .env file, their attempt was blocked, their IP is: ${geekedip}!`);
        return res.status(403).send(`:)`);
    }
    next();
});
module.exports = app;